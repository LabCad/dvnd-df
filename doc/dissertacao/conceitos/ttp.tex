\section{Problema do Mochileiro Viajante}\label{sec:ttp}

Adotemos a seguinte definição do PMV~\cite{Polyakovskiy:2014}. Dado um conjunto de cidades $ N = \{1, \dots, n\} $ e de distâncias $d_{ij}$ com $i, j \in N $ (indicando a distancia entre um par de cidades), o objetivo é visitar cada cidade exatamente uma vez sem repetições, iniciando da primeira até a última e então voltando para a primeira~\cite{Bonyadi:2013}.
Ademais, um conjunto possivelmente vazio de itens $ M_i = \{1, \dots, m_i\} $ está disponível para cada cidade $i$, cada item $k$ possui um lucro $p_{ik}$ e um peso $w_{ik}$ associados. Qualquer item pode ser coletado apenas na sua cidade até que a mochila esteja cheia (capacidade seja atendida ou o peso do item exceda a capacidade disponível), destarte o somatório de itens coletados está limitado a $W$, capacidade máxima da mochila (veículo).
Uma taxa de aluguel $R$ é paga por unidade de tempo gasta no percurso, sendo $v_{max}$ e $v_{min}$ a velocidade máxima e mínima, respectivamente, quando a mochila está cheia e vazia.

Denotemos então a rota selecionada por $x$ e sendo $y_{ik} \in \{0, 1\}$ uma variável binária igual a $1$ quando o item $k$ é coletado na cidade $i$, e $0$, caso contrário. Por último, denotemos $W_i$ o peso total da mochila no instante $i$ como o somatório do peso dos itens coletados ao sair da cidade $i$. Asism a função objetivo pode ser expressa pela Equação~\eqref{eq:fo}.
%
\begin{equation} \label{eq:fo}
\max f(x, y) = \sum\limits_{i=1}^n\sum\limits_{k = 1}^{m_i} p_{i,k}\;y_{i,k} - R
% \left(
% \frac{d_{x_n , x_1}}{v_{max} - vW_{x_n}} +
% \sum\limits_{i = 1}^{n - 1}\frac{d_{x_i , x_{i+1}}}{v_{max} - vW_{x_i}}
% \right)
\left(
\sum\limits_{i = 1}^{n - 1}\frac{d_{x_i , x_{i+1}}}{v_{max} - \nu W_{x_i}} +
\frac{d_{x_n , x_1}}{v_{max} - \nu W_{x_n}}
\right)
\end{equation}
% 
O objetivo é maximizar $f(x, y)$ dado que todas as cidades foram visitadas na rota $x$ (sem repetição) conforme Equação\ref{eq:repeatCity}, e sujeito a limitação da capacidade da mochila conforme Equação~\eqref{eq:capacity}, e a velocidade $\nu$ é dada pela Equação~\eqref{eq:currentSpeed}.
\begin{equation} \label{eq:repeatCity}
x_i = x_j \iff i = j, \forall x_i,x_j
\nu = \frac{v_{max} - v_{min}}{W}
\end{equation}

\noindent\begin{minipage}{.5\linewidth}
\begin{equation}\label{eq:capacity}
\sum\limits_{i=1}^n\sum\limits_{k = 1}^{m_i} w_{i,k}\;y_{i,k} \le W
\end{equation}

\end{minipage}
\noindent\begin{minipage}{.5\linewidth}
\begin{equation} \label{eq:currentSpeed}
\nu = \frac{v_{max} - v_{min}}{W}
\end{equation}
\end{minipage}

\subsection{Exemplo}\label{subsec:pmbExemplo}

Considere as cidade no mapa da Figura~\ref{fig:mapaItens}, existem 5 cidades e 4 itens. A cidade número 1 possui um item (de lucro 80, peso 4), cidade número 2 possui um item (lucro 50, peso 1), a cidade 3 não possui itens enquanto a cidade 4 possui 2 itens (lucro 100, peso 8 e lucro 10, peso 1).
Considerando uma velocidade mínima de 0,10, e máxima de 1,00, considere também uma mochila de capacidade 8 e uma taxa de aluguel 2,50.

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.6\linewidth]{figuras/pmv/mapaItens}
    \caption{Mapa de cidades e seus itens}
    \label{fig:mapaItens}
\end{figure}

Tomemos como exemplo a seguinte rota sem nenhum item coletado $x = \{ 1, 2, 3, 4, 5 \}$ logo $y = \{ 0, 0, 0, 0 \}$.
Para essa solução teremos o valor de função objetivo igual a -55,00.

Consideremos a gora a mesma rota coletando o item de maior lucro associado, então temos a rota $x = \{ 1, 2, 3, 4, 5 \}$, e a mochila $y = \{ 0, 0, 1, 0 \}$.
Agora teremos uma solução de valor -157,00.

Considerando ainda a mesma rota mas com dois itens coletados, temos a rota $x = \{ 1, 2, 3, 4, 5 \}$, e a mochila $y = \{ 0, 1, 0, 1 \}$.
Neste caso temos um valor de função objetivo igual a -4.70.


Nas Figuras~\ref{fig:pmvExemplo}, \ref{fig:pmvExemploAlterandoItens} e \ref{fig:pmvExemploAlterandoInicio} podemos ver a representação de soluções diferentes para a mesma instância de um PMV.
Cada apontador indica uma cidade sem itens a serem coletados, os presentes indicam itens a serem coletados com dois números associados ($p_i / w_i$, sendo $w_i$ e $p_i$ o peso e o lucro associados ao item $i$ respectivamente).
O stickman representa o início da rota, $W$ representa a capacidade de carga do veículo e $R$ a taxa de aluguel cobrada por unidade de tempo de uso do mesmo.

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.8\linewidth]{figuras/pmv/example01.png}
    \caption{Exemplo de representação visual do PMV}
    \label{fig:pmvExemplo}
\end{figure}

Pelo primeiro exemplo, na Figura~\ref{fig:pmvExemplo}, vemos que são coletados 3 itens de valores 15, 25 e 12; e pesos de valor 25, 15, 10.
Desta forma temos um percurso total de distância 74, peso final do caminhão de 50, valor dos itens de 52.
Todos estes fatores aplicados à fórmula da função objetivo conferem um valor de solução de 33,5.

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.8\linewidth]{figuras/pmv/example02.png}
    \caption{Mesmo conjunto de cidades e itens, alterando os itens coletados.}
    \label{fig:pmvExemploAlterandoItens}
\end{figure}

Mantendo a mesma rota do exemplo da Figura~\ref{fig:pmvExemplo} apenas alterando os itens coletados temos o exemplo da Figura~\ref{fig:pmvExemploAlterandoItens} que coleta apenas 2 itens de valores 35 e 25; além de pesos 35 e 15.
Neste caso se tem o mesmo peso final de 50 e um maior valor dos itens 60, contra 50 da solução anterior, porém coletar o item mais valioso e pesado logo no começo da rota prejudica todo o percurso fazendo com que sejam gastas muito mais unidades de tempo para percorrer todo o percurso, sendo um total de 128,5.
Logo temos um valor final de função objetivo de 27,875 que é menor que o anterior mesmo tendo coletado itens mais valiosos, isto ocorre porque apesar dos itens mais valiosos o custo pra coletá-los foi maior.

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.8\linewidth]{figuras/pmv/example03.png}
    \caption{Mesmo conjunto de cidades e itens, alterando inicio da rota.}
    \label{fig:pmvExemploAlterandoInicio}
\end{figure}

No caso da Figura~\ref{fig:pmvExemploAlterandoInicio} foram mantidos os itens da Figura~\ref{fig:pmvExemploAlterandoItens} contudo foi trocada a cidade inicial do problema de forma que o veículo não precise transportar o item mais pesado por um período muito longo diminuindo assim o custo da rota para 71,5.
Não tendo alterado o os itens coletados o peso final e valor dos itens também se mantem constante, desta forma o novo valor de função objetivo é de 42,875 superando os valores encontrados nas duas soluções anteriores.

Mais alguns exemplos ilustrando o problema podem ser encontrados em \cite{Bonyadi:2013, Oliveira:2015}.
